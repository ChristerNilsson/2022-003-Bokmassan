// Generated by CoffeeScript 2.5.1
var TextScroller;

TextScroller = class TextScroller {
  constructor(dx, dy, dw, dh, ts) {
    this.dx = dx;
    this.dy = dy;
    this.dw = dw;
    this.dh = dh;
    this.ts = ts;
    this.pg = createGraphics(10000, this.dh); // w
  }

  // @dx = Math.round @dx
  // @dy = Math.round @dy
  // @dw = Math.round @dw
  // @dh = Math.round @dh
  // @ts = Math.round @ts
  update(txt) {
    this.text = txt;
    push();
    textSize(this.ts);
    this.visible = this.text !== '';
    this.sz = Math.round(textWidth(this.text));
    this.scroll = this.sz > this.dw;
    if (this.scroll) {
      this.sz = Math.round(textWidth(this.text + ' • '));
      this.makeImage(this.text + ' • ' + this.text);
      this.p = 0;
    } else {
      this.makeImage(this.text);
    }
    return pop();
  }

  makeImage(txt) {
    this.pg.background("black");
    this.pg.textSize(this.ts);
    this.pg.fill("gray");
    this.pg.textAlign(LEFT, CENTER);
    return this.pg.text(txt, 0, Math.round(this.dh / 2));
  }

  draw() {
    if (this.visible) {
      if (this.scroll) {
        image(this.pg, this.dx, this.dy, this.dw, this.dh, this.p, 0, this.dw, this.dh);
        return this.p = (this.p + 1) % this.sz;
      } else {
        return image(this.pg, this.dx, this.dy);
      }
    }
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGV4dFNjcm9sbGVyLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXFRleHRTY3JvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQU0sZUFBTixNQUFBLGFBQUE7RUFDQyxXQUFjLEdBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxDQUFBO0lBQUMsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQy9CLElBQUMsQ0FBQSxFQUFELEdBQU0sY0FBQSxDQUFlLEtBQWYsRUFBc0IsSUFBQyxDQUFBLEVBQXZCLEVBRE87RUFBQSxDQUFmOzs7Ozs7O0VBUUMsTUFBUyxDQUFDLEdBQUQsQ0FBQTtJQUNSLElBQUMsQ0FBQSxJQUFELEdBQVE7SUFDUixJQUFBLENBQUE7SUFDQSxRQUFBLENBQVMsSUFBQyxDQUFBLEVBQVY7SUFDQSxJQUFDLENBQUEsT0FBRCxHQUFXLElBQUMsQ0FBQSxJQUFELEtBQVM7SUFDcEIsSUFBQyxDQUFBLEVBQUQsR0FBTSxJQUFJLENBQUMsS0FBTCxDQUFXLFNBQUEsQ0FBVSxJQUFDLENBQUEsSUFBWCxDQUFYO0lBQ04sSUFBQyxDQUFBLE1BQUQsR0FBVSxJQUFDLENBQUEsRUFBRCxHQUFNLElBQUMsQ0FBQTtJQUNqQixJQUFHLElBQUMsQ0FBQSxNQUFKO01BQ0MsSUFBQyxDQUFBLEVBQUQsR0FBTSxJQUFJLENBQUMsS0FBTCxDQUFXLFNBQUEsQ0FBVSxJQUFDLENBQUEsSUFBRCxHQUFRLEtBQWxCLENBQVg7TUFDTixJQUFDLENBQUEsU0FBRCxDQUFXLElBQUMsQ0FBQSxJQUFELEdBQVEsS0FBUixHQUFnQixJQUFDLENBQUEsSUFBNUI7TUFDQSxJQUFDLENBQUEsQ0FBRCxHQUFLLEVBSE47S0FBQSxNQUFBO01BS0MsSUFBQyxDQUFBLFNBQUQsQ0FBVyxJQUFDLENBQUEsSUFBWixFQUxEOztXQU1BLEdBQUEsQ0FBQTtFQWJROztFQWVULFNBQVksQ0FBQyxHQUFELENBQUE7SUFDWCxJQUFDLENBQUEsRUFBRSxDQUFDLFVBQUosQ0FBZSxPQUFmO0lBQ0EsSUFBQyxDQUFBLEVBQUUsQ0FBQyxRQUFKLENBQWEsSUFBQyxDQUFBLEVBQWQ7SUFDQSxJQUFDLENBQUEsRUFBRSxDQUFDLElBQUosQ0FBUyxNQUFUO0lBQ0EsSUFBQyxDQUFBLEVBQUUsQ0FBQyxTQUFKLENBQWMsSUFBZCxFQUFtQixNQUFuQjtXQUNBLElBQUMsQ0FBQSxFQUFFLENBQUMsSUFBSixDQUFTLEdBQVQsRUFBYSxDQUFiLEVBQWUsSUFBSSxDQUFDLEtBQUwsQ0FBVyxJQUFDLENBQUEsRUFBRCxHQUFJLENBQWYsQ0FBZjtFQUxXOztFQU9aLElBQU8sQ0FBQSxDQUFBO0lBQ04sSUFBRyxJQUFDLENBQUEsT0FBSjtNQUNDLElBQUcsSUFBQyxDQUFBLE1BQUo7UUFDQyxLQUFBLENBQU0sSUFBQyxDQUFBLEVBQVAsRUFBVSxJQUFDLENBQUEsRUFBWCxFQUFjLElBQUMsQ0FBQSxFQUFmLEVBQWtCLElBQUMsQ0FBQSxFQUFuQixFQUFzQixJQUFDLENBQUEsRUFBdkIsRUFBMEIsSUFBQyxDQUFBLENBQTNCLEVBQTZCLENBQTdCLEVBQStCLElBQUMsQ0FBQSxFQUFoQyxFQUFtQyxJQUFDLENBQUEsRUFBcEM7ZUFDQSxJQUFDLENBQUEsQ0FBRCxHQUFLLENBQUMsSUFBQyxDQUFBLENBQUQsR0FBRyxDQUFKLENBQUEsR0FBUyxJQUFDLENBQUEsR0FGaEI7T0FBQSxNQUFBO2VBSUMsS0FBQSxDQUFNLElBQUMsQ0FBQSxFQUFQLEVBQVUsSUFBQyxDQUFBLEVBQVgsRUFBYyxJQUFDLENBQUEsRUFBZixFQUpEO09BREQ7O0VBRE07O0FBL0JSIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVGV4dFNjcm9sbGVyXHJcblx0Y29uc3RydWN0b3IgOiAoQGR4LEBkeSxAZHcsQGRoLEB0cykgLT5cclxuXHRcdEBwZyA9IGNyZWF0ZUdyYXBoaWNzIDEwMDAwLCBAZGggIyB3XHJcblx0XHQjIEBkeCA9IE1hdGgucm91bmQgQGR4XHJcblx0XHQjIEBkeSA9IE1hdGgucm91bmQgQGR5XHJcblx0XHQjIEBkdyA9IE1hdGgucm91bmQgQGR3XHJcblx0XHQjIEBkaCA9IE1hdGgucm91bmQgQGRoXHJcblx0XHQjIEB0cyA9IE1hdGgucm91bmQgQHRzXHJcblxyXG5cdHVwZGF0ZSA6ICh0eHQpIC0+XHJcblx0XHRAdGV4dCA9IHR4dFxyXG5cdFx0cHVzaCgpXHJcblx0XHR0ZXh0U2l6ZSBAdHNcclxuXHRcdEB2aXNpYmxlID0gQHRleHQgIT0gJydcclxuXHRcdEBzeiA9IE1hdGgucm91bmQgdGV4dFdpZHRoIEB0ZXh0XHJcblx0XHRAc2Nyb2xsID0gQHN6ID4gQGR3XHJcblx0XHRpZiBAc2Nyb2xsXHJcblx0XHRcdEBzeiA9IE1hdGgucm91bmQgdGV4dFdpZHRoIEB0ZXh0ICsgJyDigKIgJ1xyXG5cdFx0XHRAbWFrZUltYWdlIEB0ZXh0ICsgJyDigKIgJyArIEB0ZXh0XHJcblx0XHRcdEBwID0gMCBcclxuXHRcdGVsc2VcclxuXHRcdFx0QG1ha2VJbWFnZSBAdGV4dFxyXG5cdFx0cG9wKCkgXHJcblxyXG5cdG1ha2VJbWFnZSA6ICh0eHQpIC0+XHJcblx0XHRAcGcuYmFja2dyb3VuZCBcImJsYWNrXCJcclxuXHRcdEBwZy50ZXh0U2l6ZSBAdHNcclxuXHRcdEBwZy5maWxsIFwiZ3JheVwiXHJcblx0XHRAcGcudGV4dEFsaWduIExFRlQsQ0VOVEVSXHJcblx0XHRAcGcudGV4dCB0eHQsMCxNYXRoLnJvdW5kIEBkaC8yXHJcblxyXG5cdGRyYXcgOiAoKSAtPlxyXG5cdFx0aWYgQHZpc2libGVcclxuXHRcdFx0aWYgQHNjcm9sbFxyXG5cdFx0XHRcdGltYWdlIEBwZyxAZHgsQGR5LEBkdyxAZGgsQHAsMCxAZHcsQGRoXHJcblx0XHRcdFx0QHAgPSAoQHArMSkgJSBAc3pcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdGltYWdlIEBwZyxAZHgsQGR5XHJcbiJdfQ==
//# sourceURL=c:\github\2022-003-Bokmassan\coffee\TextScroller.coffee