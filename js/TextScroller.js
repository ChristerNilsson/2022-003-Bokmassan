// Generated by CoffeeScript 2.5.1
var TextScroller;

TextScroller = class TextScroller {
  constructor(dx, dy, dw, dh, ts) {
    this.dx = dx;
    this.dy = dy;
    this.dw = dw;
    this.dh = dh;
    this.ts = ts;
    this.pg = createGraphics(10000, this.dh); // w
  }

  update(txt) {
    this.text = txt;
    push();
    textSize(this.ts);
    this.visible = this.text !== '';
    this.sz = Math.round(textWidth(this.text));
    this.scroll = this.sz > this.dw;
    if (this.scroll) {
      this.sz = Math.round(textWidth(this.text + ' • '));
      this.makeImage(this.text + ' • ' + this.text); // @sz+@dw+100
      this.p = 0;
    } else {
      this.makeImage(this.text);
    }
    return pop();
  }

  makeImage(txt) {
    //if not @draw then return
    this.pg.background("green");
    this.pg.textSize(this.ts);
    this.pg.fill("black");
    this.pg.textAlign(LEFT, CENTER);
    return this.pg.text(txt, 0, this.dh / 2);
  }

  draw() {
    if (this.visible) {
      fill("white");
      if (this.scroll) {
        text(this.text, this.dx, this.dy + this.dh / 2);
        //image @pg,@dx,@dy,@dw,@dh,@p,0,@dw,@dh
        return this.p = (this.p + 1) % this.sz;
      } else {
        //image @pg,@dx,@dy
        return text(this.text, this.dx, this.dy + this.dh / 2);
      }
    }
  }

};

// class TextScroller
// 	constructor : (@dx,@dy,@dw,@dh,@ts) ->
// 		@pg = createGraphics 10000, @dh  # 2000

// 	update : (txt) ->
// 		@text = txt
// 		@visible = @text != ''
// 		push()
// 		textSize @ts
// 		@sz = Math.round textWidth @text
// 		@scroll = @sz > @dw
// 		if @scroll
// 			@sz = Math.round textWidth @text + ' • '
// 			@makeImage @text + ' • ' + @text
// 			@p = 0
// 		else
// 			@makeImage @text
// 			@p = null
// 		pop()

// 	makeImage : (txt) ->
// 		@pg.background "green"
// 		@pg.textSize @ts
// 		@pg.fill "white"
// 		@pg.textAlign LEFT,CENTER
// 		@pg.text txt,0,@dh/2

// 	draw : () ->
// 		# push()
// 		# textSize @ts
// 		# rect @dx,@dy,@dw,@dh
// 		# textAlign LEFT,CENTER
// 		# text "#{@visible} #{@scroll} #{@text}",@dx,@dy+@dh/2
// 		# pop()

// 		push()
// 		if @visible
// 			image @pg, 0,@dy-@dh
// 			if @scroll
// 				image @pg, @dx,@dy,@dw,@dh, @p,0,@dw,@dh
// 				@p = (@p+1) % @sz
// 			else
// 				image @pg, @dx,@dy
// 		pop()

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGV4dFNjcm9sbGVyLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXFRleHRTY3JvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQU0sZUFBTixNQUFBLGFBQUE7RUFDQyxXQUFjLEdBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxDQUFBO0lBQUMsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQUcsSUFBQyxDQUFBO0lBQy9CLElBQUMsQ0FBQSxFQUFELEdBQU0sY0FBQSxDQUFlLEtBQWYsRUFBc0IsSUFBQyxDQUFBLEVBQXZCLEVBRE87RUFBQTs7RUFHZCxNQUFTLENBQUMsR0FBRCxDQUFBO0lBQ1IsSUFBQyxDQUFBLElBQUQsR0FBUTtJQUNSLElBQUEsQ0FBQTtJQUNBLFFBQUEsQ0FBUyxJQUFDLENBQUEsRUFBVjtJQUNBLElBQUMsQ0FBQSxPQUFELEdBQVcsSUFBQyxDQUFBLElBQUQsS0FBUztJQUNwQixJQUFDLENBQUEsRUFBRCxHQUFNLElBQUksQ0FBQyxLQUFMLENBQVcsU0FBQSxDQUFVLElBQUMsQ0FBQSxJQUFYLENBQVg7SUFDTixJQUFDLENBQUEsTUFBRCxHQUFVLElBQUMsQ0FBQSxFQUFELEdBQU0sSUFBQyxDQUFBO0lBQ2pCLElBQUcsSUFBQyxDQUFBLE1BQUo7TUFDQyxJQUFDLENBQUEsRUFBRCxHQUFNLElBQUksQ0FBQyxLQUFMLENBQVcsU0FBQSxDQUFVLElBQUMsQ0FBQSxJQUFELEdBQVEsS0FBbEIsQ0FBWDtNQUNOLElBQUMsQ0FBQSxTQUFELENBQVcsSUFBQyxDQUFBLElBQUQsR0FBUSxLQUFSLEdBQWdCLElBQUMsQ0FBQSxJQUE1QixFQURIO01BRUcsSUFBQyxDQUFBLENBQUQsR0FBSyxFQUhOO0tBQUEsTUFBQTtNQUtDLElBQUMsQ0FBQSxTQUFELENBQVcsSUFBQyxDQUFBLElBQVosRUFMRDs7V0FNQSxHQUFBLENBQUE7RUFiUTs7RUFlVCxTQUFZLENBQUMsR0FBRCxDQUFBLEVBQUE7O0lBRVgsSUFBQyxDQUFBLEVBQUUsQ0FBQyxVQUFKLENBQWUsT0FBZjtJQUNBLElBQUMsQ0FBQSxFQUFFLENBQUMsUUFBSixDQUFhLElBQUMsQ0FBQSxFQUFkO0lBQ0EsSUFBQyxDQUFBLEVBQUUsQ0FBQyxJQUFKLENBQVMsT0FBVDtJQUNBLElBQUMsQ0FBQSxFQUFFLENBQUMsU0FBSixDQUFjLElBQWQsRUFBbUIsTUFBbkI7V0FDQSxJQUFDLENBQUEsRUFBRSxDQUFDLElBQUosQ0FBUyxHQUFULEVBQWEsQ0FBYixFQUFlLElBQUMsQ0FBQSxFQUFELEdBQUksQ0FBbkI7RUFOVzs7RUFRWixJQUFPLENBQUEsQ0FBQTtJQUNOLElBQUcsSUFBQyxDQUFBLE9BQUo7TUFDQyxJQUFBLENBQUssT0FBTDtNQUNBLElBQUcsSUFBQyxDQUFBLE1BQUo7UUFDQyxJQUFBLENBQUssSUFBQyxDQUFBLElBQU4sRUFBVyxJQUFDLENBQUEsRUFBWixFQUFlLElBQUMsQ0FBQSxFQUFELEdBQUksSUFBQyxDQUFBLEVBQUQsR0FBSSxDQUF2QixFQUFKOztlQUVJLElBQUMsQ0FBQSxDQUFELEdBQUssQ0FBQyxJQUFDLENBQUEsQ0FBRCxHQUFHLENBQUosQ0FBQSxHQUFTLElBQUMsQ0FBQSxHQUhoQjtPQUFBLE1BQUE7O2VBTUMsSUFBQSxDQUFLLElBQUMsQ0FBQSxJQUFOLEVBQVcsSUFBQyxDQUFBLEVBQVosRUFBZSxJQUFDLENBQUEsRUFBRCxHQUFJLElBQUMsQ0FBQSxFQUFELEdBQUksQ0FBdkIsRUFORDtPQUZEOztFQURNOztBQTNCUjs7QUFBQSIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRleHRTY3JvbGxlclxyXG5cdGNvbnN0cnVjdG9yIDogKEBkeCxAZHksQGR3LEBkaCxAdHMpIC0+XHJcblx0XHRAcGcgPSBjcmVhdGVHcmFwaGljcyAxMDAwMCwgQGRoICMgd1xyXG5cclxuXHR1cGRhdGUgOiAodHh0KSAtPlxyXG5cdFx0QHRleHQgPSB0eHRcclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dFNpemUgQHRzXHJcblx0XHRAdmlzaWJsZSA9IEB0ZXh0ICE9ICcnXHJcblx0XHRAc3ogPSBNYXRoLnJvdW5kIHRleHRXaWR0aCBAdGV4dFxyXG5cdFx0QHNjcm9sbCA9IEBzeiA+IEBkd1xyXG5cdFx0aWYgQHNjcm9sbFxyXG5cdFx0XHRAc3ogPSBNYXRoLnJvdW5kIHRleHRXaWR0aCBAdGV4dCArICcg4oCiICdcclxuXHRcdFx0QG1ha2VJbWFnZSBAdGV4dCArICcg4oCiICcgKyBAdGV4dCAjIEBzeitAZHcrMTAwXHJcblx0XHRcdEBwID0gMCBcclxuXHRcdGVsc2VcclxuXHRcdFx0QG1ha2VJbWFnZSBAdGV4dFxyXG5cdFx0cG9wKCkgXHJcblxyXG5cdG1ha2VJbWFnZSA6ICh0eHQpIC0+XHJcblx0XHQjaWYgbm90IEBkcmF3IHRoZW4gcmV0dXJuXHJcblx0XHRAcGcuYmFja2dyb3VuZCBcImdyZWVuXCJcclxuXHRcdEBwZy50ZXh0U2l6ZSBAdHNcclxuXHRcdEBwZy5maWxsIFwiYmxhY2tcIlxyXG5cdFx0QHBnLnRleHRBbGlnbiBMRUZULENFTlRFUlxyXG5cdFx0QHBnLnRleHQgdHh0LDAsQGRoLzJcclxuXHJcblx0ZHJhdyA6ICgpIC0+XHJcblx0XHRpZiBAdmlzaWJsZVxyXG5cdFx0XHRmaWxsIFwid2hpdGVcIlxyXG5cdFx0XHRpZiBAc2Nyb2xsXHJcblx0XHRcdFx0dGV4dCBAdGV4dCxAZHgsQGR5K0BkaC8yXHJcblx0XHRcdFx0I2ltYWdlIEBwZyxAZHgsQGR5LEBkdyxAZGgsQHAsMCxAZHcsQGRoXHJcblx0XHRcdFx0QHAgPSAoQHArMSkgJSBAc3pcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdCNpbWFnZSBAcGcsQGR4LEBkeVxyXG5cdFx0XHRcdHRleHQgQHRleHQsQGR4LEBkeStAZGgvMlxyXG5cclxuXHJcblxyXG5cclxuXHJcbiMgY2xhc3MgVGV4dFNjcm9sbGVyXHJcbiMgXHRjb25zdHJ1Y3RvciA6IChAZHgsQGR5LEBkdyxAZGgsQHRzKSAtPlxyXG4jIFx0XHRAcGcgPSBjcmVhdGVHcmFwaGljcyAxMDAwMCwgQGRoICAjIDIwMDBcclxuXHJcbiMgXHR1cGRhdGUgOiAodHh0KSAtPlxyXG4jIFx0XHRAdGV4dCA9IHR4dFxyXG4jIFx0XHRAdmlzaWJsZSA9IEB0ZXh0ICE9ICcnXHJcbiMgXHRcdHB1c2goKVxyXG4jIFx0XHR0ZXh0U2l6ZSBAdHNcclxuIyBcdFx0QHN6ID0gTWF0aC5yb3VuZCB0ZXh0V2lkdGggQHRleHRcclxuIyBcdFx0QHNjcm9sbCA9IEBzeiA+IEBkd1xyXG4jIFx0XHRpZiBAc2Nyb2xsXHJcbiMgXHRcdFx0QHN6ID0gTWF0aC5yb3VuZCB0ZXh0V2lkdGggQHRleHQgKyAnIOKAoiAnXHJcbiMgXHRcdFx0QG1ha2VJbWFnZSBAdGV4dCArICcg4oCiICcgKyBAdGV4dFxyXG4jIFx0XHRcdEBwID0gMFxyXG4jIFx0XHRlbHNlXHJcbiMgXHRcdFx0QG1ha2VJbWFnZSBAdGV4dFxyXG4jIFx0XHRcdEBwID0gbnVsbFxyXG4jIFx0XHRwb3AoKVxyXG5cclxuIyBcdG1ha2VJbWFnZSA6ICh0eHQpIC0+XHJcbiMgXHRcdEBwZy5iYWNrZ3JvdW5kIFwiZ3JlZW5cIlxyXG4jIFx0XHRAcGcudGV4dFNpemUgQHRzXHJcbiMgXHRcdEBwZy5maWxsIFwid2hpdGVcIlxyXG4jIFx0XHRAcGcudGV4dEFsaWduIExFRlQsQ0VOVEVSXHJcbiMgXHRcdEBwZy50ZXh0IHR4dCwwLEBkaC8yXHJcblxyXG4jIFx0ZHJhdyA6ICgpIC0+XHJcbiMgXHRcdCMgcHVzaCgpXHJcbiMgXHRcdCMgdGV4dFNpemUgQHRzXHJcbiMgXHRcdCMgcmVjdCBAZHgsQGR5LEBkdyxAZGhcclxuIyBcdFx0IyB0ZXh0QWxpZ24gTEVGVCxDRU5URVJcclxuIyBcdFx0IyB0ZXh0IFwiI3tAdmlzaWJsZX0gI3tAc2Nyb2xsfSAje0B0ZXh0fVwiLEBkeCxAZHkrQGRoLzJcclxuIyBcdFx0IyBwb3AoKVxyXG5cclxuIyBcdFx0cHVzaCgpXHJcbiMgXHRcdGlmIEB2aXNpYmxlXHJcbiMgXHRcdFx0aW1hZ2UgQHBnLCAwLEBkeS1AZGhcclxuIyBcdFx0XHRpZiBAc2Nyb2xsXHJcbiMgXHRcdFx0XHRpbWFnZSBAcGcsIEBkeCxAZHksQGR3LEBkaCwgQHAsMCxAZHcsQGRoXHJcbiMgXHRcdFx0XHRAcCA9IChAcCsxKSAlIEBzelxyXG4jIFx0XHRcdGVsc2VcclxuIyBcdFx0XHRcdGltYWdlIEBwZywgQGR4LEBkeVxyXG4jIFx0XHRwb3AoKSJdfQ==
//# sourceURL=c:\github\2022-003-Bokmassan\coffee\TextScroller.coffee